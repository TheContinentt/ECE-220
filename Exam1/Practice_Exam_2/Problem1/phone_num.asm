.ORIG x3000

;your program starts here			
		AND R1, R1, #0			;COUNTER OF DIGITS
		AND R4, R4, #0
		AND R3, R3, #0
		AND R6, R6, #0
		AND R0, R0, #0
		AND R5, R5, #0
		LD R5, STOREE

POLL		GETC
		LD R4, NEW_CHAR			;EVALUATE
		NOT R4, R4
		ADD R4, R4, #1
		ADD R4, R4, R0
		BRz FINISHH
		LD R4, NEW_CHARR
		NOT R4, R4
		ADD R4, R4, #1
		ADD R4, R4, R0
		BRz FINISH
		ADD R6, R6, #1
		LD R4, ZERO_CHAR
		NOT R4, R4
		ADD R4, R4, #1
		ADD R4, R4, R0
		BRn INVALID
		LD R4, NINE_CHAR
		NOT R4, R4
		ADD R4, R4, #1
		ADD R4, R4, R0
		BRp INVALID

VALID		ADD R1, R1, #0		
		BRnzp STORE

INVALID		ADD R1, R1, #1
		BRnzp STORE
STORE		LD R2, STOREE
		STI R0, STOREE
		ADD R2, R2, #1
		ST R2, STOREE
		BRnzp POLL

FINISHH		ADD R2, R5, #0
		LDR R0, R5, #0
		OUT
		ADD R5, R5, #1
		ADD R6, R6, #-1
		BRp FINISHH

FINISH		ADD R1, R1, #0
		BRp FAIL

SUCCESS		LD R2, VALUE
		ADD R2, R2, #10
		NOT R2, R2
		ADD R2, R2, #1
		ADD R5, R5, R2
		BRnp FAIL
		LD R0, SCHAR
		OUT
		LEA R0, VAL_MSG
		PUTS
		BRnzp TRAPP

FAIL		LD R0, SCHAR
		OUT
		LEA R0, INV_MSG
		PUTS		

TRAPP	TRAP x25

KBSR    .FILL xFE00
KBDR    .FILL xFE02
DSR     .FILL xFE04
DDR     .FILL xFE06
INV_MSG .STRINGZ "Invalid Phone Number."
VAL_MSG .STRINGZ "Valid Phone Number."
ZERO_CHAR	.FILL x0030
NINE_CHAR	.FILL x0039
NEW_CHAR	.FILL x000A
NEW_CHARR	.FILL x000D
STOREE	.FILL x5000
VALUE	.FILL x5000
SCHAR	.FILL x002D
.END
